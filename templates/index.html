<html>
    <head>
        <title>Aadhar Reader</title>
        <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
        <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
        <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
        <link rel="stylesheet" href="static/css/styles.css">
            <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">

        <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>

        <!-- For loading bar -->
        <link rel="stylesheet" href="static/css/nprogress.css">
        <script src="static/js/nprogress.js"></script>

    </head>
    
    <body id="aadhar-app">
        <div id="loadingbar-frame"></div>


          <div class="demo-layout mdl-layout mdl-layout--fixed-header mdl-js-layout mdl-color--grey-100">
      <header class="demo-headers mdl-layout__header mdl-layout__header--scroll mdl-color--grey-100 mdl-color-text--grey-800">
        <div class="mdl-layout__header-row">
          <span class="mdl-layout-title">Aadhar Reader</span>
          <div class="mdl-layout-spacer"></div>
        </div>
      </header>
      <div class="demo-ribbon"></div>
      <main class="demo-main mdl-layout__content">
        <div class="demo-container mdl-grid">
          <div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone"></div>
          <div class="demo-content mdl-color--white mdl-shadow--4dp content mdl-color-text--grey-800 mdl-cell mdl-cell--8-col">
    
            <h3>Authenticate yourself</h3>
              
                <div class="box" id="input"><!-- flex item -->
                    <form action="/" method="POST" enctype="multipart/form-data">
                        <label for="sound_input">Upload your Aadhar Card:</label>
                        <input type="file" name="aadhar_file" id="aadhar_input" accept=".jpg,.png,.tiff,.jpeg" required="required" />
                        <div class="mdl-textfield mdl-js-textfield">
                            <label for="name_input" class="mdl-textfield__label">Enter your name here:</label>                        
                            <input type="text" name="person_name" id="name_input" class="mdl-textfield__input" required/>
                        </div>
                        <input type="submit" value="Submit" 
                        id="form-submit"
                        class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent" />
                    </form>
                </div>

                <div class="box" id="output"><!-- flex item -->
                    {{ message }}
                    {% if text %}
                        <p> {{ text }} </p>
                    {% endif %}
                        </div>

                    
                </div>

          </div>
        </div>
 
      </main>
    </div>

    <script>
           var data = new FormData(jQuery('form')[0]);

            var files;

            // Add events
            $('input[type=file]').on('change', prepareUpload);

            // Grab the files and set them to our variable
            function prepareUpload(event)
            {
                files = event.target.files;
            }

            $('form').on('submit', function(e){ 
                e.preventDefault();
                NProgress.start();      
                            
            var data = new FormData();
            $.each(files, function(key, value)
            {
                data.append('aadhar_file', value);
            });
            data.append('person_name', $('#name_input').val());

        
              $.post({
                    url: "authorize",
                    data: data,
                    processData: false,  // tell jQuery not to process the data
                    contentType: false,   // tell jQuery not to set contentType                    data: dataArr,
                    success: function(data) {
                        NProgress.done();
                        console.log(data);
                    },
                    error: function(data) {
                        NProgress.done();
                        console.log(data);
                    }

                });          

            });




    </script>

    </body>

</html>